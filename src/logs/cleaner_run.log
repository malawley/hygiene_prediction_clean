[2025-03-31 15:30:07,215] Using ADC credentials for project: hygiene-prediction
[2025-03-31 15:30:07,215] Credentials type: <class 'google.oauth2.credentials.Credentials'>
[2025-03-31 15:30:07,216] Credentials scopes: None
[2025-03-31 15:30:07,216] Quota project ID: hygiene-prediction
[2025-03-31 15:30:07,216] === Starting cleaning for 2025-03-31 ===
[2025-03-31 15:30:07,970] Processing file: offset_0.json
[2025-03-31 15:30:08,458] Starting with 1000 rows
[2025-03-31 15:30:08,461] After dropping nulls (except 'violations'): 981 rows
[2025-03-31 15:30:08,462] Dropped 124 rows with missing violations and invalid results
[2025-03-31 15:30:08,462] Preserved 156 'Pass' rows with no violations
[2025-03-31 15:30:08,462] Final cleaned row count: 857
[2025-03-31 15:30:08,462] After cleaner_1_drop: shape = (857, 14)
[2025-03-31 15:30:08,463] Dropped 0 duplicate inspection_id rows
[2025-03-31 15:30:08,464] Dropped 0 rows with invalid inspection_id format
[2025-03-31 15:30:08,464] Final row count after inspection_id checks: 857
[2025-03-31 15:30:08,464] After cleaner_2_inspection_id: shape = (857, 14)
[2025-03-31 15:30:08,481] Column Normalization Summary: dba_name             | Unique after: 704
[2025-03-31 15:30:08,482] Column Normalization Summary: facility_type        | Unique after: 22
[2025-03-31 15:30:08,485] Column Normalization Summary: risk                 | Unique after: 3
[2025-03-31 15:30:08,487] Column Normalization Summary: address              | Unique after: 708
[2025-03-31 15:30:08,488] Column Normalization Summary: city                 | Unique after: 1
[2025-03-31 15:30:08,490] Column Normalization Summary: state                | Unique after: 1
[2025-03-31 15:30:08,491] Column Normalization Summary: inspection_type      | Unique after: 8
[2025-03-31 15:30:08,492] Column Normalization Summary: results              | Unique after: 4
[2025-03-31 15:30:08,493] Column Normalization Summary: violations           | Unique after: 701
[2025-03-31 15:30:08,493] After cleaner_3_text_normalization: shape = (857, 14)
[2025-03-31 15:30:08,520] After cleaner_4_values_consolidation: shape = (857, 14)
[2025-03-31 15:30:08,525] After cleaner_5_facility_type: shape = (857, 15)
[2025-03-31 15:30:08,526] After cleaner_6_inspection_type: shape = (857, 15)
[2025-03-31 15:30:08,526] After cleaner_7_results: shape = (857, 15)
[2025-03-31 15:30:08,527] After cleaner_8_geolocation: shape = (857, 15)
[2025-03-31 15:30:08,567] After cleaner_9_tokenize_violations: shape = (857, 18)
[2025-03-31 15:30:13,271] Uploaded JSON to gs://cleaned-inspection-data-row/clean-data/2025-03-31/offset_0.json
[2025-03-31 15:30:17,598] Uploaded Parquet to gs://cleaned-inspection-data-column/clean-data/2025-03-31/offset_0.parquet
[2025-03-31 15:30:17,598] Processing file: offset_1000.json
[2025-03-31 15:30:18,063] Starting with 1000 rows
[2025-03-31 15:30:18,065] After dropping nulls (except 'violations'): 990 rows
[2025-03-31 15:30:18,066] Dropped 120 rows with missing violations and invalid results
[2025-03-31 15:30:18,066] Preserved 171 'Pass' rows with no violations
[2025-03-31 15:30:18,066] Final cleaned row count: 870
[2025-03-31 15:30:18,066] After cleaner_1_drop: shape = (870, 14)
[2025-03-31 15:30:18,067] Dropped 0 duplicate inspection_id rows
[2025-03-31 15:30:18,068] Dropped 0 rows with invalid inspection_id format
[2025-03-31 15:30:18,068] Final row count after inspection_id checks: 870
[2025-03-31 15:30:18,068] After cleaner_2_inspection_id: shape = (870, 14)
[2025-03-31 15:30:18,083] Column Normalization Summary: dba_name             | Unique after: 681
[2025-03-31 15:30:18,085] Column Normalization Summary: facility_type        | Unique after: 21
[2025-03-31 15:30:18,086] Column Normalization Summary: risk                 | Unique after: 3
[2025-03-31 15:30:18,087] Column Normalization Summary: address              | Unique after: 691
[2025-03-31 15:30:18,088] Column Normalization Summary: city                 | Unique after: 1
[2025-03-31 15:30:18,090] Column Normalization Summary: state                | Unique after: 1
[2025-03-31 15:30:18,091] Column Normalization Summary: inspection_type      | Unique after: 8
[2025-03-31 15:30:18,091] Column Normalization Summary: results              | Unique after: 4
[2025-03-31 15:30:18,092] Column Normalization Summary: violations           | Unique after: 700
[2025-03-31 15:30:18,092] After cleaner_3_text_normalization: shape = (870, 14)
[2025-03-31 15:30:18,108] After cleaner_4_values_consolidation: shape = (870, 14)
[2025-03-31 15:30:18,113] After cleaner_5_facility_type: shape = (870, 15)
[2025-03-31 15:30:18,113] After cleaner_6_inspection_type: shape = (870, 15)
[2025-03-31 15:30:18,114] After cleaner_7_results: shape = (870, 15)
[2025-03-31 15:30:18,116] After cleaner_8_geolocation: shape = (870, 15)
[2025-03-31 15:30:18,154] After cleaner_9_tokenize_violations: shape = (870, 18)
[2025-03-31 15:30:22,878] Uploaded JSON to gs://cleaned-inspection-data-row/clean-data/2025-03-31/offset_1000.json
[2025-03-31 15:30:27,404] Uploaded Parquet to gs://cleaned-inspection-data-column/clean-data/2025-03-31/offset_1000.parquet
[2025-03-31 15:30:27,404] Processing file: offset_2000.json
[2025-03-31 15:30:27,844] Starting with 1000 rows
[2025-03-31 15:30:27,845] After dropping nulls (except 'violations'): 993 rows
[2025-03-31 15:30:27,846] Dropped 124 rows with missing violations and invalid results
[2025-03-31 15:30:27,846] Preserved 165 'Pass' rows with no violations
[2025-03-31 15:30:27,846] Final cleaned row count: 869
[2025-03-31 15:30:27,846] After cleaner_1_drop: shape = (869, 14)
[2025-03-31 15:30:27,847] Dropped 0 duplicate inspection_id rows
[2025-03-31 15:30:27,848] Dropped 0 rows with invalid inspection_id format
[2025-03-31 15:30:27,848] Final row count after inspection_id checks: 869
[2025-03-31 15:30:27,848] After cleaner_2_inspection_id: shape = (869, 14)
[2025-03-31 15:30:27,862] Column Normalization Summary: dba_name             | Unique after: 676
[2025-03-31 15:30:27,862] Column Normalization Summary: facility_type        | Unique after: 21
[2025-03-31 15:30:27,863] Column Normalization Summary: risk                 | Unique after: 3
[2025-03-31 15:30:27,864] Column Normalization Summary: address              | Unique after: 701
[2025-03-31 15:30:27,864] Column Normalization Summary: city                 | Unique after: 1
[2025-03-31 15:30:27,866] Column Normalization Summary: state                | Unique after: 1
[2025-03-31 15:30:27,868] Column Normalization Summary: inspection_type      | Unique after: 8
[2025-03-31 15:30:27,869] Column Normalization Summary: results              | Unique after: 4
[2025-03-31 15:30:27,870] Column Normalization Summary: violations           | Unique after: 705
[2025-03-31 15:30:27,870] After cleaner_3_text_normalization: shape = (869, 14)
[2025-03-31 15:30:27,893] After cleaner_4_values_consolidation: shape = (869, 14)
[2025-03-31 15:30:27,899] After cleaner_5_facility_type: shape = (869, 15)
[2025-03-31 15:30:27,899] After cleaner_6_inspection_type: shape = (869, 15)
[2025-03-31 15:30:27,900] After cleaner_7_results: shape = (869, 15)
[2025-03-31 15:30:27,900] After cleaner_8_geolocation: shape = (869, 15)
[2025-03-31 15:30:27,943] After cleaner_9_tokenize_violations: shape = (869, 18)
[2025-03-31 15:30:32,733] Uploaded JSON to gs://cleaned-inspection-data-row/clean-data/2025-03-31/offset_2000.json
[2025-03-31 15:30:36,996] Uploaded Parquet to gs://cleaned-inspection-data-column/clean-data/2025-03-31/offset_2000.parquet
[2025-03-31 15:30:36,996] Processing file: offset_3000.json
[2025-03-31 15:30:37,491] Starting with 1000 rows
[2025-03-31 15:30:37,493] After dropping nulls (except 'violations'): 989 rows
[2025-03-31 15:30:37,495] Dropped 129 rows with missing violations and invalid results
[2025-03-31 15:30:37,495] Preserved 157 'Pass' rows with no violations
[2025-03-31 15:30:37,495] Final cleaned row count: 860
[2025-03-31 15:30:37,495] After cleaner_1_drop: shape = (860, 14)
[2025-03-31 15:30:37,495] Dropped 0 duplicate inspection_id rows
[2025-03-31 15:30:37,497] Dropped 0 rows with invalid inspection_id format
[2025-03-31 15:30:37,497] Final row count after inspection_id checks: 860
[2025-03-31 15:30:37,497] After cleaner_2_inspection_id: shape = (860, 14)
[2025-03-31 15:30:37,512] Column Normalization Summary: dba_name             | Unique after: 645
[2025-03-31 15:30:37,512] Column Normalization Summary: facility_type        | Unique after: 22
[2025-03-31 15:30:37,513] Column Normalization Summary: risk                 | Unique after: 3
[2025-03-31 15:30:37,514] Column Normalization Summary: address              | Unique after: 683
[2025-03-31 15:30:37,516] Column Normalization Summary: city                 | Unique after: 1
[2025-03-31 15:30:37,517] Column Normalization Summary: state                | Unique after: 1
[2025-03-31 15:30:37,520] Column Normalization Summary: inspection_type      | Unique after: 7
[2025-03-31 15:30:37,522] Column Normalization Summary: results              | Unique after: 4
[2025-03-31 15:30:37,522] Column Normalization Summary: violations           | Unique after: 704
[2025-03-31 15:30:37,522] After cleaner_3_text_normalization: shape = (860, 14)
[2025-03-31 15:30:37,548] After cleaner_4_values_consolidation: shape = (860, 14)
[2025-03-31 15:30:37,553] After cleaner_5_facility_type: shape = (860, 15)
[2025-03-31 15:30:37,555] After cleaner_6_inspection_type: shape = (860, 15)
[2025-03-31 15:30:37,555] After cleaner_7_results: shape = (860, 15)
[2025-03-31 15:30:37,557] After cleaner_8_geolocation: shape = (860, 15)
[2025-03-31 15:30:37,604] After cleaner_9_tokenize_violations: shape = (860, 18)
[2025-03-31 15:30:42,366] Uploaded JSON to gs://cleaned-inspection-data-row/clean-data/2025-03-31/offset_3000.json
[2025-03-31 15:30:46,656] Uploaded Parquet to gs://cleaned-inspection-data-column/clean-data/2025-03-31/offset_3000.parquet
[2025-03-31 15:30:48,764] Wrote _manifest.json to gs://cleaned-inspection-data-row/clean-data/2025-03-31/
[2025-03-31 15:30:50,919] Wrote _manifest.json to gs://cleaned-inspection-data-column/clean-data/2025-03-31/
[2025-03-31 15:30:50,920] === Finished cleaning for 2025-03-31 ===
